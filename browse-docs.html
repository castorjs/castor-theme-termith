{% extends "layout.html" %}

{% block content %}
    <!--end head block  -->
    </head>
    <body id="bodyBrowse">

        <header>
            <nav>
                <ul>
                    <li>
                        <a href=""></a>
                    </li>
                    <li>
                        <a href=""></a>
                    </li>
                </ul>
            </nav>
        </header>

        <!-- start body content -->
        <h1 id="h1Browse">Br<span style="color: #FF8E80;">o</span>wse b<span style="color: #99E5DB">y</span> <span style="color: #FF917F">d</span>ocuments</h1>

        <div id="divOverTableBrowse" class="col-lg-9">
          {% if items|length > 0  %}
            <table id="browseTable">
                <thead>
                    <tr>
                        <th class="browseNumbTh col-lg-1">N°</th>
                        <th class="browseYearTh  col-lg-2">ANNEE</th>
                        <th class="browseAuthorTh  col-lg-2">AUTEUR</th>
                        <th class="browseTitleTh  col-lg-6">TITRE</th>
                        <th class="browseMarkTh  col-lg-1">NOTE</th>
                    </tr>
                </thead>
                <tbody>
                      {% for item in items |sort(attribute='item.object') %}
                        <tr class="trBody" data-href="./display-{{ item.wid }}.html">
                            <td class="browseNumb browseTd"><div class="divAbrowseNumber">{{ loop.index }}</div></td>
                            <td class="browseYear browseTd">{{item.content.json.TEI.teiHeader.fileDesc.publicationStmt.availability.licence["notBefore"]|d('Pas d\'année') }}</td>
                            <td class="browseAuthor browseTd">{{item.content.json.TEI.teiHeader.fileDesc.titleStmt.respStmt.persName[0].forename['#text']|d('Pas d\'auteur') +" " + item.content.json.TEI.teiHeader.fileDesc.titleStmt.respStmt.persName[0].surname['#text']|d(" ") }} </td>
                            <td class="browseTitle browseTd"><a class="abrowseTitle" href="./display-{{ item.wid }}.html">{{ item.content.json.TEI.teiHeader.fileDesc.titleStmt.title[0]['#text']|d('Pas de titre')|capitalize|truncate( 99, False, '...') }}</a></td>
                            <td class="browseMark browseTd"><span class="spanBrowseMark">{{ item.description|d('/20') }}</span></td>
                        </tr>
                        <tr class="browseTdInter">
                        </tr>
                      {% endfor %}
                </tbody>
            </table>

            {% else %}
                <div class="divNoDocs col-lg-8" style=""> <span class="spanDivNoDocs">:(</span> Aucun document trouvé !</div>
            {% endif %}
        </div>

        <script>

            var trs = document.querySelectorAll('.trBody'); // Récupération de tous les TR du tBody

            /*
            * Fonction qui redirige vers le data-href de l'objet Event "element"
            * */
            var goToLocation  = function(element){
                window.location = element.currentTarget.getAttribute('data-href');
            };


            for(var i = 0, c = trs.length; i<c ; i++){ // Boucle qui écoute l'evenement click sur les Tr et appelle goToLocation

                trs[i].addEventListener('click', goToLocation , false);

            }

        </script>


{% endblock %}
