{% extends "layout.html" %}



{% block head %}
    <link rel="stylesheet" type="text/css" href="/assets/css/full-article.css">
{% endblock %}



{% block content %}


<body id="bodyBrowse">




{% set numberOfMethods = 0 %}

{% set allKeywordsMethods = [] %}

{% set currentNbMethod = 0 %}

{% set listOfMethodsName = [] %}

{% set inistListofKw = []%}

{% set inistScheme = '' %}

{% set isFullArticle = config.fullArticle %}

{% set isInistKeywords = config.inistKeywords %}




<!--  Count number of Methods present and their names -->

{%  for keywordsEval in item.keywords.eval %}

    {% set listOfMethodsName = listOfMethodsName|add2Array(keywordsEval.scheme) %}

    {% set tempListKw  = [] %}

    {% for currentKeyword in keywordsEval.term %}

        {% set tempListKw = tempListKw|add2Array(currentKeyword['#text']) %}

    {% endfor %}

    {% set allKeywordsMethods =  allKeywordsMethods|add2Array(tempListKw) %}

{% endfor %}

{% set inistScheme = item.keywords.silence[0].scheme %}

{% for currentKeyword in item.keywords.silence[0].term %}

    {% set inistListofKw = inistListofKw|add2Array(currentKeyword['#text']) %}

{% endfor %}


{% set numberOfMethods = listOfMethodsName|length %}


    <!-- Block of modal for full article -->
    {% if isFullArticle == true %}
    <div id="buttonFullArticle" class="">
        <span class="glyphicon glyphicon-align-center" id="spanFullArticle"></span>
        <span id="closeFullArticle" class="glyphicon glyphicon-remove"></span>
        <div id="fullArticleSection">
        </div>
    </div>
    {% endif %}

    <div id="contentDisplay" class="col-lg-11 col-md-11 col-sm-11">



            <!-- LEFT BLOC -->
            <aside id="leftSection" class="col-lg-2 col-md-2 col-sm-2">

                <header id="headerInfoDisplayDocs">


                    <!-- THE NAV BAR -->
                    <div class="divTopDisplay">

                        <div id="divNavMiddle" class="col-lg-12 col-md-12 col-sm-12">
                            <p>
                                <a href="/index.html">Liste</a> <!-- Return to browse Docs-->
                            </p>
                        </div>

                    </div>
                    <div id="timer">

                    </div>
                    {% if item.validationDocument != 'yes' %}
                        <span class="glyphicon glyphicon-play isRunning" id="startOrStop"></span>
                    {% endif %}

                    <!-- NAME BLOC -->
                    <div class="displayDiscipline">
                        <div class="disciplineInfoDisplay">
                            <span>{{ config.domain|d('non renseigné !') }}</span>
                        </div>
                    </div>

                   <div id="listOrGrid">
                        <span id="grid" class="glyphicon glyphicon-th gridOrListButton" style="opacity : 1"></span>
                        <span id="list" class="glyphicon glyphicon-list active gridOrListButton"></span>
                    </div>

                    <div data-id="{{ item.wid }}" id="validateMethodBar" class="progress {% if item.validate  == 'yes' %}isValidated{% endif %}">
                    </div>

                    <div id="validateDocument" data-id="{{ item.wid }}" class="progress {% if item.validateDocument  == 'yes' %}isValidated{% endif %}" {% if item.validationMethods == "yes" %}style="display:block"{% else %}style="display:none"{% endif %}></div>


                    <!-- METHOD BLOC -->
                    <div class="displayMethodBu">

                        <div  class="methodsNameDisplayD">

                            {% for buttons in range(0,numberOfMethods) %}

                                <div id="methodButton-{{ loop.index0 }}" class="methodLinkround">

                                    <span>Méthode {{ loop.index }}</span>

                                </div>

                            {% endfor %}

                        </div>

                    </div>

                </header>


                <!-- RESUME BLOC -->
                <section id="sectionArticle">

                    <span class="glyphicon glyphicon-align-left resumeGliph" id="backAbsctract"></span>

                    <article id="articleSectionResumeDisplay" style="">

                        <p>
                            {{ item.fields.abstract|d('Pas de resume') }}
                        </p>

                    </article>

                </section>

            </aside>


            <!-- RIGHT  BLOCK (Keywords) -->
            <section id="keywordsSection" class="col-lg-10 col-md-10 col-sm-10">

                <div class="divHoverH1Display col-lg-12 col-md-12 col-sm-12">

                    <div id="h1Block">
                        <h1 id="h1DisplayDocs">

                            {{ item.fields.title|d('Pas de titre') }}

                        </h1>
                    </div>

                    <div id="arroundedBlock">

                    </div>

                </div>

                <p id="abstractFullLenght">
                    {{ item.fields.abstract|d('Pas de resume') }}
                </p>


                <div id="keywordsDisplayDiv" class="col-lg-12 col-md-12 col-sm-12">


                            {% if ( isInistKeywords == true) and (inistListofKw != '') and (inistListofKw != []) and (inistListofKw != undifined) %}

                                <div id="keywordsInist">

                                    <h2> INIST </h2>

                                    {%  for currentInistKw in inistListofKw %}

                                        {% set inistLoopKeyword  = loop.index0 %}

                                        {% for theInist in range(0,numberOfMethods) %}

                                            {% set loopIndexMethodInist = loop.index0 %}

                                        <div class="btn btn-default inistForMethod-{{ loopIndexMethodInist }} {% if ((item.keywords.silence[loopIndexMethodInist].term[inistLoopKeyword].score) or (item.keywords.silence[loopIndexMethodInist].term[inistLoopKeyword].score == 0)) %} keywordsMethodsDisplayDone {% else %} keywordsMethodsDisplay {% endif %}"><span class="idOfWord">{{ inistLoopKeyword+1 }} - </span> {{ currentInistKw|d('Pas de mots clés') }}

                                            <form class="formNotedKeyword row" id="silenceScore-{{ loopIndexMethodInist }}-{{ inistLoopKeyword }}" name="formNotedKeyword" action="/save/{{ item.wid }}" method="post">

                                                <input class="inistKey" type="hidden" name="key" value="keywords.silence.{{ loopIndexMethodInist }}.term.{{ inistLoopKeyword }}.score"/><!-- Key Name -->

                                                <!-- Value Name -->
                                                {% if item.keywords.silence[loopIndexMethodInist].term[inistLoopKeyword].score == '2' %}
                                                <input id="input0-silence-{{ loopIndexMethodInist }}.term.{{ inistLoopKeyword }}" name="val" type="radio" value="0"><label for="input0-silence-{{ loopIndexMethodInist }}.term.{{ inistLoopKeyword }}" class="{% if item.validationDocument == 'yes' %}labelHide{% endif %}">0</label>
                                                <input id="input1-silence-{{ loopIndexMethodInist }}.term.{{ inistLoopKeyword }}" name="val" type="radio" value="1"><label for="input1-silence-{{ loopIndexMethodInist }}.term.{{ inistLoopKeyword }}" class="{% if item.validationDocument == 'yes' %}labelHide{% endif %}">1</label>
                                                <input id="input2-silence-{{ loopIndexMethodInist }}.term.{{ inistLoopKeyword }}" name="val" type="radio" value="2" checked><label for="input2-silence-{{ loopIndexMethodInist }}.term.{{ inistLoopKeyword }}" class="{% if item.validationDocument == 'yes' %}labelBlock{% endif %}">2</label>
                                                {% elif item.keywords.silence[loopIndexMethodInist].term[inistLoopKeyword].score == '1' %}
                                                <input id="input0-silence-{{ loopIndexMethodInist }}.term.{{ inistLoopKeyword }}" name="val" type="radio" value="0"><label for="input0-silence-{{ loopIndexMethodInist }}.term.{{ inistLoopKeyword }}" class="{% if item.validationDocument == 'yes' %}labelHide{% endif %}">0</label>
                                                <input id="input1-silence-{{ loopIndexMethodInist }}.term.{{ inistLoopKeyword }}" name="val" type="radio" value="1" checked><label for="input1-silence-{{ loopIndexMethodInist }}.term.{{ inistLoopKeyword }}" class="{% if item.validationDocument == 'yes' %}labelBlock{% endif %}">1</label>
                                                <input id="input2-silence-{{ loopIndexMethodInist }}.term.{{ inistLoopKeyword }}" name="val" type="radio" value="2"><label for="input2-silence-{{ loopIndexMethodInist }}.term.{{ inistLoopKeyword }}" class="{% if item.validationDocument == 'yes' %}labelHide{% endif %}">2</label>
                                                {% elif item.keywords.silence[loopIndexMethodInist].term[inistLoopKeyword].score == '0' %}
                                                <input id="input0-silence-{{ loopIndexMethodInist }}.term.{{ inistLoopKeyword }}" name="val" type="radio" value="0" checked><label for="input0-silence-{{ loopIndexMethodInist }}.term.{{ inistLoopKeyword }}" class="{% if item.validationDocument == 'yes' %}labelBlock{% endif %}">0</label>
                                                <input id="input1-silence-{{ loopIndexMethodInist }}.term.{{ inistLoopKeyword }}" name="val" type="radio" value="1"><label for="input1-silence-{{ loopIndexMethodInist }}.term.{{ inistLoopKeyword }}" class="{% if item.validationDocument == 'yes' %}labelHide{% endif %}">1</label>
                                                <input id="input2-silence-{{ loopIndexMethodInist }}.term.{{ inistLoopKeyword }}" name="val" type="radio" value="2"><label for="input2-silence-{{ loopIndexMethodInist }}.term.{{ inistLoopKeyword }}" class="{% if item.validationDocument == 'yes' %}labelHide{% endif %}">2</label>
                                                {% else %}
                                                <input id="input0-silence-{{ loopIndexMethodInist }}.term.{{ inistLoopKeyword }}" name="val" type="radio" value="0"><label for="input0-silence-{{ loopIndexMethodInist }}.term.{{ inistLoopKeyword }}" class="{% if item.validationDocument == 'yes' %}labelHide{% endif %}">0</label>
                                                <input id="input1-silence-{{ loopIndexMethodInist }}.term.{{ inistLoopKeyword }}" name="val" type="radio" value="1"><label for="input1-silence-{{ loopIndexMethodInist }}.term.{{ inistLoopKeyword }}" class="{% if item.validationDocument == 'yes' %}labelHide{% endif %}">1</label>
                                                <input id="input2-silence-{{ loopIndexMethodInist }}.term.{{ inistLoopKeyword }}" name="val" type="radio" value="2"><label for="input2-silence-{{ loopIndexMethodInist }}.term.{{ inistLoopKeyword }}" class="{% if item.validationDocument == 'yes' %}labelHide{% endif %}">2</label>
                                                {% endif %}

                                                <ins class="loading"></ins>

                                            </form>

                                            <form class="formNotedKeyword formNotedKeywordsPreference row {% if item.validationDocument == 'yes' %}labelHide{% endif %}" id="correspMethod-{{ loopIndexMethodInist }}-{{ inistLoopKeyword }}" action="/save/{{ item.wid }}">

                                                <input type="hidden" name="key" value="keywords.silence.{{ loopIndexMethodInist }}.term.{{ inistLoopKeyword }}.correspondance"/> <!-- Key Name -->

                                                <select id="method-{{ loopIndexMethodInist }}-corresp-list-{{ inistLoopKeyword }}" class="formNotedKeywordList" name="val">
                                                    <option value="<corresp>">
                                                        Corresp:
                                                    </option>
                                                    {% for methodsWord in allKeywordsMethods[loopIndexMethodInist] %}

                                                    <option value="{{ methodsWord }}" {% if item.keywords.silence[loopIndexMethodInist].term[inistLoopKeyword].correspondance == methodsWord %} selected="selected" style="background: #FF847C;color:#fff"{% endif %}><!-- Select the select word in mongo -->
                                                    {{ methodsWord }}
                                                    </option>

                                                    {% endfor %}
                                                </select>

                                            </form>

                                            <div class="divComments {% if item.validationDocument == 'yes' %}labelHide{% endif %}">
                                                <span class="etcSpanComment">...</span>

                                                <span class="quitSpanComment">X</span>

                                                <div class="divFormComments">

                                                    <form  data-id="{{ item.wid }}" action="/save/{{ item.wid }}" style="height:100%;padding:0; margin: 0">
                                                        <input type="hidden" name="key" value="keywords.silence.{{ loopIndexMethodInist }}.term.{{ inistLoopKeyword }}.commentaire"/> <!-- Key Name -->
                                                        <input name="val" class="inputComment"  type="text" placeholder="Commentaire :" value="{{ item.keywords.silence[loopIndexMethodInist].term[inistLoopKeyword].commentaire }}"/>
                                                    </form>
                                                </div>

                                            </div>

                                        </div>

                                        {% endfor %}

                                    {% endfor %}

                                </div>

                            {% endif %}


                            {% for methods in allKeywordsMethods %}

                                {% set currentNbMethod = currentNbMethod+1 %}

                                <div id="method{{ currentNbMethod-1 }}ListOfKeywords" class="methodsKeywords">

                                    <h2> Methode {{ currentNbMethod }} </h2>

                                            {% for methodsWord in methods %}

                                            {% set wordNumber = loop.index0 %}

                                            <div class="btn btn-default {% if ((item.keywords.eval[currentNbMethod-1].term[wordNumber].score) or (item.keywords.eval[currentNbMethod-1].term[wordNumber].score == 0)) %} keywordsMethodsDisplayDone {% else %} keywordsMethodsDisplay {% endif %}"> <span class="idOfWord">{{ loop.index }} - </span>{{ methodsWord|d('Pas de mots clés') }}

                                                <form class="formNotedKeyword row" id="method-{{ currentNbMethod }}-{{ loop.index }}" name="formNotedKeyword" action="/save/{{ item.wid }}" method="post">

                                                    <input type="hidden" name="key" value="keywords.eval.{{ currentNbMethod-1 }}.term.{{ wordNumber }}.score"/><!-- Key Name -->

                                                    <!-- Value Name -->
                                                    {% if item.keywords.eval[currentNbMethod-1].term[wordNumber].score == '2' %}
                                                    <input id="input0-{{ currentNbMethod-1 }}.{{ loop.index }}" name="val" type="radio" value="0"><label for="input0-{{ currentNbMethod-1 }}.{{ loop.index }}"  class="{% if item.validationMethods == 'yes' %}labelHide{% endif %}">0</label>
                                                    <input id="input1-{{ currentNbMethod-1 }}.{{ loop.index }}" name="val" type="radio" value="1" ><label for="input1-{{ currentNbMethod-1 }}.{{ loop.index }}"  class="{% if item.validationMethods == 'yes' %}labelHide{% endif %}">1</label>
                                                    <input id="input2-{{ currentNbMethod-1 }}.{{ loop.index }}" name="val" type="radio" value="2" checked><label for="input2-{{ currentNbMethod-1 }}.{{ loop.index }}"  class="{% if item.validationMethods == 'yes' %}labelBlock{% endif %}">2</label>
                                                    {% elif item.keywords.eval[currentNbMethod-1].term[wordNumber].score == '1' %}
                                                    <input id="input0-{{ currentNbMethod-1 }}.{{ loop.index }}" name="val" type="radio" value="0"><label for="input0-{{ currentNbMethod-1 }}.{{ loop.index }}"  class="{% if item.validationMethods == 'yes' %}labelHide{% endif %}">0</label>
                                                    <input id="input1-{{ currentNbMethod-1 }}.{{ loop.index }}" name="val" type="radio" value="1" checked><label for="input1-{{ currentNbMethod-1 }}.{{ loop.index }}"  class="{% if item.validationMethods == 'yes' %}labelBlock{% endif %}">1</label>
                                                    <input id="input2-{{ currentNbMethod-1 }}.{{ loop.index }}" name="val" type="radio" value="2"><label for="input2-{{ currentNbMethod-1 }}.{{ loop.index }}"  class="{% if item.validationMethods == 'yes' %}labelHide{% endif %}">2</label>
                                                    {% elif item.keywords.eval[currentNbMethod-1].term[wordNumber].score == '0' %}
                                                    <input id="input0-{{ currentNbMethod-1 }}.{{ loop.index }}" name="val" type="radio" value="0" checked><label for="input0-{{ currentNbMethod-1 }}.{{ loop.index }}"  class="{% if item.validationMethods == 'yes' %}labelBlock{% endif %}">0</label>
                                                    <input id="input1-{{ currentNbMethod-1 }}.{{ loop.index }}" name="val" type="radio" value="1"><label for="input1-{{ currentNbMethod-1 }}.{{ loop.index }}"  class="{% if item.validationMethods == 'yes' %}labelHide{% endif %}">1</label>
                                                    <input id="input2-{{ currentNbMethod-1 }}.{{ loop.index }}" name="val" type="radio" value="2"><label for="input2-{{ currentNbMethod-1 }}.{{ loop.index }}"  class="{% if item.validationMethods == 'yes' %}labelHide{% endif %}">2</label>
                                                    {% else %}
                                                    <input id="input0-{{ currentNbMethod-1 }}.{{ loop.index }}" name="val" type="radio" value="0"><label for="input0-{{ currentNbMethod-1 }}.{{ loop.index }}"  class="{% if item.validationMethods == 'yes' %}labelHide{% endif %}">0</label>
                                                    <input id="input1-{{ currentNbMethod-1 }}.{{ loop.index }}" name="val" type="radio" value="1"><label for="input1-{{ currentNbMethod-1 }}.{{ loop.index }}"  class="{% if item.validationMethods == 'yes' %}labelHide{% endif %}">1</label>
                                                    <input id="input2-{{ currentNbMethod-1 }}.{{ loop.index }}" name="val" type="radio" value="2"><label for="input2-{{ currentNbMethod-1 }}.{{ loop.index }}"  class="{% if item.validationMethods == 'yes' %}labelHide{% endif %}">2</label>
                                                    {% endif %}

                                                    <ins class="loading"></ins>

                                                </form>

                                                <form class="formNotedKeyword formNotedKeywordsPreference row {% if item.validationMethods == 'yes' %}labelHide{% endif %}" id="prefMethod-{{ currentNbMethod }}-{{ loop.index }}" action="/save/{{ item.wid }}">

                                                    <input type="hidden" name="key" value="keywords.eval.{{ currentNbMethod-1 }}.term.{{ wordNumber }}.exclude"/> <!-- Key Name -->

                                                    <select id="method-{{ currentNbMethod }}-exclude-list-{{ loop.index }}" class="formNotedKeywordList" name="val">

                                                        <option value="<exclude>">
                                                            Pref:
                                                        </option>

                                                        {%  for sameListKeywords in methods %}
                                                            <!-- {{ sameListKeywords }} / {{ item.keywords.eval[currentNbMethod-1].term[wordNumber].exclude }} -->

                                                            <option value="{{ sameListKeywords }}" {% if item.keywords.eval[currentNbMethod-1].term[wordNumber].exclude == sameListKeywords %} selected="selected" style="background: #FF847C;color:#fff"{% endif %}><!-- Select the select word in mongo -->
                                                            {{ sameListKeywords }}
                                                            </option>

                                                        {% endfor %}

                                                    </select>

                                                </form>

                                                <div class="divComments {% if item.validationMethods == 'yes' %}labelHide{% endif %}">
                                                    <span class="etcSpanComment">...</span>

                                                    <span class="quitSpanComment">X</span>

                                                    <div class="divFormComments">

                                                        <form  data-id="{{ item.wid }}" action="/save/{{ item.wid }}" style="height:100%;padding:0; margin: 0">
                                                            <input type="hidden" name="key" value="keywords.eval.{{ currentNbMethod-1 }}.term.{{ wordNumber }}.comment"/> <!-- Key Name -->
                                                            <input name="val" class="inputComment" type="text" placeholder="Commentaire :" value="{{ item.keywords.eval[currentNbMethod-1].term[wordNumber].comment }}"/>
                                                        </form>
                                                    </div>

                                                </div>



                                            </div>

                                            {% endfor %}



                                </div>

                            {% endfor %}

                </div> <!-- End of Block Keywords -->

            </section> <!-- End of Right  Section (Keywords) -->


    </div>

    {% if isInistKeywords == true %}
        <div id="inistKeywordsButton" {% if item.validationMethods == "yes" %}style="display : block"{% else %}style="display: none"{% endif %}">
            <span>Afficher INIST</span>  <!-- Button to call Inist Keywords -->
        </div>
    {% endif %}



{% endblock %}

{% block scripts %}

<!-- SCRIPTS  DISPLAY PAGE -->

<script src="/assets/js/jquery.runner.js" type="text/javascript"></script>

<script src="/assets/js/jquery.fs.scroller.min.js"></script>

<script src="/assets/js/display.js"></script>




{% endblock %}
