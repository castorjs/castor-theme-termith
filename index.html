{% extends "layout.html" %}

{% block content %}
    <!--end head block  -->
    </head>
    <body id="bodyBrowse">

        <header>
            <nav>
                <ul>
                    <li>
                        <a href=""></a>
                    </li>
                    <li>
                        <a href=""></a>
                    </li>
                </ul>
            </nav>
        </header>

        <!-- start body content -->
        <div class="col-lg-9" id="BrowseDocuBigDiv">
            <h1 id="h1Browse" class="col-lg-11">
                L<span style="color: #FF8E80;">i</span>ste d<span style="color: #99E5DB">e</span>s <span style="color: #FF917F">d</span>ocuments{{ errorExport }}<br/>

                <span id="spanLogos">
                    <a class="linkLogosPatner" target="_blank" rel="nofollow" href="http://www.cnrs.fr/"><img class="partnerLogos" src="assets/pictures/logo_cnrs.png" alt="logo du cnrs" /></a>
                    <a class="linkLogosPatner" target="_blank" rel="nofollow" href="http://www.univ-lorraine.fr/"><img class="partnerLogos"src="assets/pictures/logo_UL.png" alt="logo de l'université de Lorraine"  /></a>
                    <a class="linkLogosPatner" target="_blank" rel="nofollow" href="http://www.atilf.fr/"><img class="partnerLogos"src="assets/pictures/Logo_ATILF.png" alt="logo de l'ATILF" /></a>
                    <a class="linkLogosPatner" target="_blank" rel="nofollow" href="http://www.anr.fr/"><img class="partnerLogos"src="assets/pictures/anr.png" alt="logo de l'ANR" /></a>
                </span>
            </h1>

            <div id="exportResults" class="btn btn-default" data-href="/exportscore">Exporter les résultats</div>



            <div id="divOverTableBrowse" class="col-lg-12">
                <table id="browseTable" width="100%">
                    <div id="selectBrowseDocs">
                        <label for="browseChangeList">Afficher :</label>
                        <select name="browseChangeList" id="browseChangeList">
                            <option value="tous" selected="selected">Tous</option>
                            <option value="traites">Traités</option>
                            <option value="nonTraites">Non traités</option>
                        </select>
                    </div>
                    <thead id="menuThead">
                        <tr>
                            <th class="browseNumbTh col-lg-1">N°</th>
                            <th class="browseNumbTh col-lg-1">VALIDATION</th>
                            <th class="browseYearTh  col-lg-2">DOCUMENT</th>
                            <th class="browseTitleTh  col-lg-6">TITRE</th>
                        </tr>
                    </thead>
                    <tbody>
                    <tr class="trBody" data-href="">
                    </tr>
                    </tbody>
               </table>
            </div>
        </div>

{% endblock %}

{% block scripts %}
<script> var $ = jQuery = require('jquery'); </script>
<script src="./assets/js/jquery.dataTables.js"></script>
<script src="./assets/js/dataTables.bootstrap.js"></script>
<script>
//document.location.href = '/browse.html';

$(document).ready(function() {

		  var oTable = $('#browseTable').dataTable({
            "search" : {
                "regex" : true
            },
			ordering: true,
            info : false,
			ajax: "/browse.json",
            serverSide: true,
            lengthMenu : [15,1,3,5,10,25,50,100,200,500],
            "language": {
                "lengthMenu": " _MENU_ Documents/Page",
                "search": "Rechercher:",
                "paginate": {
                  "previous": "Précédent",
                  "next" : "Suivant",
              }
            },
			columns: [
				{ data: 'wid' , visible : false , searchable: false},
				{ data: 'validate', visible : false , searchable: false , defaultContent: 'no' },
				{ data: 'object' , className: "browseYear browseTd", searchable: true},
				{ data: 'fields.title' , className: "browseTitle browseTd", searchable: true}
			],

            "rowCallback": function ( row ) {
            },

            "fnDrawCallback": function(){

                $('tbody tr').on('click',function() {
                    //var id = $(this).find('td:first').text();
                    var position =  oTable.fnGetPosition(this);
                    var docID = oTable.fnGetData( position );
                    document.location.href = "/display/" + docID.wid + '.html';
                }).addClass('trBody');



                $('.trBody').hover(function() {
                    $(this).css('cursor', 'pointer');
                }, function() {
                    $(this).css('cursor', 'auto');
                });
            }
		});

        /* Add event listener to the dropdown input */
        $('#browseChangeList').on('change', function() {
            if( $(this).val() == 'traites'){
                oTable.fnFilter( 'yes' , 1 );
            }
            else if( $(this).val() == 'nonTraites'){
                oTable.fnFilter( 'no' , 1 );
            }
            else{
                oTable.fnGetData( '' , 1);
            }
        } );



        var thead = $('#menuThead');
        var off = thead.offset();


        $(window).scroll(function () {
            if ($(this).scrollTop() > 541) {
                thead.addClass("fixedThead");
            } else {
                thead.removeClass("fixedThead");
            }
        });
});

</script>
{% endblock %}

