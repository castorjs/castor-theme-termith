{% extends "layout.html" %}

{% block content %}
    <!--end head block  -->
    </head>
    <body id="bodyBrowse">

        <header>
            <nav>
                <ul>
                    <li>
                        <a href=""></a>
                    </li>
                    <li>
                        <a href=""></a>
                    </li>
                </ul>
            </nav>
        </header>

        <!-- start body content -->
        <div  class="col-lg-9" id="BrowseDocuBigDiv">

            <h1 id="h1Browse" class="col-lg-11">

                L<span style="color: #FF8E80;">i</span>ste d<span style="color: #99E5DB">e</span>s <span style="color: #FF917F">d</span>ocuments{{ errorExport }}<br/>

                <span id="spanLogos">
                    <a class="linkLogosPatner" target="_blank" rel="nofollow" href="http://www.cnrs.fr/"><img class="partnerLogos" src="assets/pictures/logo_cnrs.png" alt="logo du cnrs" /></a>
                    <a class="linkLogosPatner" target="_blank" rel="nofollow" href="http://www.univ-lorraine.fr/"><img class="partnerLogos"src="assets/pictures/logo_UL.png" alt="logo de l'université de Lorraine"  /></a>
                    <a class="linkLogosPatner" target="_blank" rel="nofollow" href="http://www.atilf.fr/"><img class="partnerLogos"src="assets/pictures/Logo_ATILF.png" alt="logo de l'ATILF" /></a>
                    <a class="linkLogosPatner" target="_blank" rel="nofollow" href="http://www.anr.fr/"><img class="partnerLogos"src="assets/pictures/anr.png" alt="logo de l'ANR" /></a>
                </span>
            </h1>

            <div id="exportResults" class="btn btn-default" data-href="/exportscore">Exporter les résultats</div>

            <div id="selectBrowseDocs">
                <label for="browseChangeList">Filter :</label>
                <select name="browseChangeList" id="browseChangeList">
                    <option value="tous" selected="selected">Tous</option>
                    <option value="traites">Traités</option>
                    <option value="nonTraites">Non traités</option>
                </select>
            </div>

            <div id="divOverTableBrowse" class="col-lg-12">
              {% if data|length > 0  %}
                <table id="browseTable">
                    <thead>
                        <tr>
                            <th class="browseNumbTh col-lg-1">N°</th>
                            <th class="browseYearTh  col-lg-2">DOCUMENT</th>
                            <th class="browseTitleTh  col-lg-6">TITRE</th>
                        </tr>
                    </thead>
                    <tbody>
                          {% for item in data |sort(attribute='item.object') %}
                            <tr class="trBody {% if item.validate == 'yes' %}trValidate{% else %}trNotValidate{% endif %}" data-href="display/{{ item.wid }}.html">
                                <td class="browseNumb browseTd"><div class="divAbrowseNumber">{{ loop.index }}</div></td>
                                <td class="browseYear browseTd">{{item.object|d('Nom à problémes') }}</td>
                                <td class="browseTitle browseTd"><a class="abrowseTitle" href="display/{{ item.wid }}.html">
                                    {{ item.fields.title }}
                                </a>
                                </td>
                            </tr>
                            <tr class="browseTdInter">
                            </tr>
                          {% endfor %}
                    </tbody>
                </table>

                {% else %}
                    <div class="divNoDocs col-lg-8" style=""> <span class="spanDivNoDocs">:(</span> Aucun document trouvé !</div>
                {% endif %}
            </div>
        </div>

        <script src="/assets/js/jquery-1.11.1.min.js"></script>

        <script>



            /*
            * Fonction which get data-href of element
            *
            * */
            var goToLocation  = function(element){
                window.location = element.currentTarget.getAttribute('data-href');
            };

            var trs = document.querySelectorAll('.trBody'); // get all tr of Tbody


            for(var i = 0, c = trs.length; i<c ; i++){ // listen to all tr in the table

                trs[i].addEventListener('click', goToLocation , false);

            }

            // Get data-href of csv score & redirect to it
            $('#exportResults').on('click' , goToLocation);

            $('#browseChangeList').on('change' ,function(e){
               if($(this).val() == 'tous'){
                   $('.trNotValidate , .trNotValidate + .browseTdInter').show();
                   $('.trValidate , .trValidate + .browseTdInter').show();
               }
               else if($(this).val() == 'traites'){
                   $('.trNotValidate , .trNotValidate + .browseTdInter').fadeOut(200);
                   $('.trValidate , .trValidate + .browseTdInter').fadeIn(200);
               }
               else if($(this).val() == 'nonTraites'){
                   $('.trValidate , .trValidate + .browseTdInter').fadeOut(200);
                   $('.trNotValidate  ,.trNotValidate + .browseTdInter').fadeIn(200);
               }
            });






        </script>

{% endblock %}
